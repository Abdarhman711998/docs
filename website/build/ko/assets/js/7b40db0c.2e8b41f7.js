"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8622],{97389:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>c,metadata:()=>a,toc:()=>l});var r=t(85893),s=t(11151);const c={sidebar_position:1},i="near",a={id:"sdk/rust/contract-structure/near-bindgen",title:"near",description:"The #[near] macro is used on a struct and the function implementations to generate the necessary code to be a valid NEAR contract and expose the intended functions to be able to be called externally.",source:"@site/i18n/ko/docusaurus-plugin-content-docs/current/sdk/rust/contract-structure/near-bindgen.md",sourceDirName:"sdk/rust/contract-structure",slug:"/sdk/rust/contract-structure/near-bindgen",permalink:"/ko/sdk/rust/contract-structure/near-bindgen",draft:!1,unlisted:!1,editUrl:"https://github.com/near/docs/edit/master/website/../docs/sdk/rust/contract-structure/near-bindgen.md",tags:[],version:"current",lastUpdatedBy:"Github Actions",lastUpdatedAt:1704996595e3,sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tools",previous:{title:"\uc2dc\uc791\ud558\uae30",permalink:"/ko/sdk/rust/get-started"},next:{title:"\uceec\ub809\uc158",permalink:"/ko/sdk/rust/contract-structure/collections"}},o={},l=[{value:"\ucd08\uae30\ud654 \uba54\uc11c\ub4dc",id:"\ucd08\uae30\ud654-\uba54\uc11c\ub4dc",level:2},{value:"\uc9c0\ubd88 \uba54\uc11c\ub4dc",id:"\uc9c0\ubd88-\uba54\uc11c\ub4dc",level:2},{value:"\ud504\ub77c\uc774\ube57 \uba54\uc11c\ub4dc",id:"\ud504\ub77c\uc774\ube57-\uba54\uc11c\ub4dc",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"near",children:"near"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"#[near]"})," macro is used on a ",(0,r.jsx)(n.code,{children:"struct"})," and the function implementations to generate the necessary code to be a valid NEAR contract and expose the intended functions to be able to be called externally."]}),"\n",(0,r.jsx)(n.p,{children:"\uc608\ub97c \ub4e4\uc5b4 \uac04\ub2e8\ud55c counter \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c \ub9e4\ud06c\ub85c\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \uc801\uc6a9\ub429\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"use near_sdk::near;\n\n#[near(contract_state)]\n#[derive(Default)]\npub struct Counter {\n    value: u64,\n}\n\n#[near]\nimpl Counter {\n    pub fn increment(&mut self) {\n        self.value += 1;\n    }\n\n    pub fn get_count(&self) -> u64 {\n        self.value\n    }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\uc774 \uc608\uc5d0\uc11c ",(0,r.jsx)(n.code,{children:"Counter"})," \uad6c\uc870\uccb4\ub294 \uc2a4\ub9c8\ud2b8 \ucee8\ud2b8\ub799\ud2b8 \uc0c1\ud0dc\uc640 ",(0,r.jsx)(n.code,{children:"BorshSerialize"}),"\uc640 ",(0,r.jsx)(n.code,{children:"BorshDeserialize"}),"\ub97c \uad6c\ud604\ud558\ub294 \ubaa8\ub4e0 \uac83\uc744 \ub098\ud0c0\ub0c5\ub2c8\ub2e4(\uc2ec\uc9c0\uc5b4 ",(0,r.jsx)(n.code,{children:"collections"}),"\ub3c4 \ud3ec\ud568). \ud568\uc218\uac00 \ud638\ucd9c\ub420 \ub54c\ub9c8\ub2e4, \uc0c1\ud0dc\uac00 \ub85c\ub4dc\ub418\uace0 \uc5ed\uc9c1\ub82c\ud654\ub418\ubbc0\ub85c, \ub85c\ub4dc\ub418\ub294 \ub370\uc774\ud130 \uc591\uc744 \uac00\ub2a5\ud55c \ud55c \ucd5c\uc18c\ud654\ud558\ub294 \uac83\uc774 \uc911\uc694\ud569\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"#[near]"})," also annotates the ",(0,r.jsx)(n.code,{children:"impl"})," for ",(0,r.jsx)(n.code,{children:"Counter"})," and this will generate any necessary boilerplate to expose the functions. \uba85\uc2ec\ud574\uc57c \ud560 \uc911\uc694\ud55c \ud575\uc2ec \uc0c1\ud638 \uc791\uc6a9\uc740 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\ubaa8\ub4e0 ",(0,r.jsx)(n.code,{children:"pub"})," \ud568\uc218\ub294 \ubaa8\ub4e0 \uacc4\uc815/\ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c \uc678\ubd80\uc801\uc73c\ub85c \ud638\ucd9c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\uc790\uc138\ud55c \ub0b4\uc6a9\uc740 ",(0,r.jsx)(n.a,{href:"/ko/sdk/rust/contract-interface/public-methods",children:"\uacf5\uc6a9 \uba54\uc11c\ub4dc"}),"\ub97c \ucc38\uc870\ud558\uc138\uc694."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"self"}),"\ub294 ",(0,r.jsx)(n.a,{href:"/ko/sdk/rust/contract-interface/contract-mutability",children:"\ucee8\ud2b8\ub799\ud2b8\uc758 \uac00\ubcc0\uc131(mutability)"}),"\uc744 \uc81c\uc5b4\ud558\uae30 \uc704\ud574 \uc5ec\ub7ec \uac00\uc9c0 \ubc29\ubc95\uc73c\ub85c \uc0ac\uc6a9\ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"&self"})," \ub610\ub294 ",(0,r.jsx)(n.code,{children:"self"}),"\ub97c \ucde8\ud558\ub294 \ud568\uc218\ub294 \uc77d\uae30 \uc804\uc6a9\uc774\uace0, \uc5c5\ub370\uc774\ud2b8\ub41c \uc0c1\ud0dc\ub97c \uc2a4\ud1a0\ub9ac\uc9c0\uc5d0 \uc4f0\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"&mut self"}),"\ub97c \ucde8\ud558\ub294 \ud568\uc218\ub294 \uc0c1\ud0dc \ubcc0\uacbd\uc744 \ud5c8\uc6a9\ud558\uace0, \ud568\uc218 \ud638\ucd9c\uc774 \ub05d\ub0a0 \ub54c \ud56d\uc0c1 \uc0c1\ud0dc\ub97c \ub2e4\uc2dc \uae30\ub85d\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\uacf5\uac1c\ub41c \ud568\uc218\ub294 ",(0,r.jsx)(n.code,{children:"self"}),"\uac00 \ud568\uc218 \ub9e4\uac1c\ubcc0\uc218\uc5d0 \ud3ec\ud568\ub418\uc9c0 \uc54a\uc740 \uacbd\uc6b0 \uc0c1\ud0dc\uc5d0 \ub300\ud55c \uc77d\uae30 \ubc0f \uc4f0\uae30\ub97c \uc0dd\ub7b5\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\uc774\ub294 \uc77c\ubd80 \uc815\uc801 \uae30\ub2a5 \ub610\ub294 \ucee8\ud2b8\ub799\ud2b8 \ucf54\ub4dc\uc5d0 \ud3ec\ud568\ub41c \ub370\uc774\ud130 \ubc18\ud658\uc5d0 \uc720\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\ud568\uc218\uc5d0 \ubc18\ud658 \uac12\uc774 \uc788\uc73c\uba74, \uc774\ub294 ",(0,r.jsx)(n.code,{children:"env::value_return"}),"\ub97c \ud1b5\ud574 \uacb0\uacfc\uc801\uc73c\ub85c \uc9c1\ub82c\ud654\ub418\uace0 \uc5f0\uacb0\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\ucd08\uae30\ud654-\uba54\uc11c\ub4dc",children:"\ucd08\uae30\ud654 \uba54\uc11c\ub4dc"}),"\n",(0,r.jsxs)(n.p,{children:["\uae30\ubcf8\uc801\uc73c\ub85c \ucee8\ud2b8\ub799\ud2b8\uc758 ",(0,r.jsx)(n.code,{children:"Default::default()"})," \uad6c\ud604\uc740 \ucee8\ud2b8\ub799\ud2b8\ub97c \ucd08\uae30\ud654\ud558\ub294 \ub370 \uc0ac\uc6a9\ub429\ub2c8\ub2e4. \ub2e4\uc74c ",(0,r.jsx)(n.code,{children:"#[init]"})," \uc8fc\uc11d\uacfc \ud568\uaed8 \ub9e4\uac1c\ubcc0\uc218\ub97c \uc0ac\uc6a9\ud558\uac70\ub098 \uc0ac\uc6a9\uc790 \uc815\uc758 \ub17c\ub9ac\ub97c \uc218\ud589\ud558\ub294 \uc0ac\uc6a9\uc790 \uc815\uc758 \ucd08\uae30\ud654 \ud568\uc218\uac00 \uc788\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:'#[near]\nimpl Counter {\n    #[init]\n    pub fn new(value: u64) -> Self {\n        log!("Custom counter initialization!");\n        Self { value }\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\ubaa8\ub4e0 \ucee8\ud2b8\ub799\ud2b8\ub294 ",(0,r.jsx)(n.code,{children:"Default"}),"\ub97c \uad6c\ud604\ud558\uac8c \ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4. \uae30\ubcf8 \uad6c\ud604\uc774 \uc0ac\uc6a9\ub418\ub294 \uac83\uc744 \uae08\uc9c0\ud558\ub824\uba74 ",(0,r.jsx)(n.code,{children:"PanicOnDefault"})," \ud30c\uc0dd \ub9e4\ud06c\ub85c\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"#[near(contract_state)]\n#[derive(PanicOnDefault)]\npub struct Counter {\n    // ...\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\uc9c0\ubd88-\uba54\uc11c\ub4dc",children:"\uc9c0\ubd88 \uba54\uc11c\ub4dc"}),"\n",(0,r.jsxs)(n.p,{children:["\uba54\uc11c\ub4dc \ud638\ucd9c\uc744 \ud1b5\ud574 \ud1a0\ud070\uc744 \uc804\uc1a1\ud560 \uc218 \uc788\ub3c4\ub85d \uba54\uc11c\ub4dc\uc5d0 ",(0,r.jsx)(n.code,{children:"#[payable]"})," \uc8fc\uc11d\uc744 \ub2ec \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc790\uc138\ud55c \ub0b4\uc6a9\uc740 ",(0,r.jsx)(n.a,{href:"/ko/sdk/rust/contract-interface/payable-methods",children:"\uc9c0\ubd88 \uba54\uc11c\ub4dc"}),"\ub97c \ucc38\uc870\ud558\uc138\uc694."]}),"\n",(0,r.jsxs)(n.p,{children:["\ud568\uc218\ub97c \uc9c0\ubd88 \uac00\ub2a5\ud55c \uac83\uc73c\ub85c \uc120\uc5b8\ud558\ub824\uba74, \ub2e4\uc74c\uacfc \uac19\uc774 ",(0,r.jsx)(n.code,{children:"#[payable]"})," \uc8fc\uc11d\uc744 \uc0ac\uc6a9\ud558\uc138\uc694."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"#[payable]\npub fn my_method(&mut self) {\n...\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\ud504\ub77c\uc774\ube57-\uba54\uc11c\ub4dc",children:"\ud504\ub77c\uc774\ube57 \uba54\uc11c\ub4dc"}),"\n",(0,r.jsxs)(n.p,{children:["\ucee8\ud2b8\ub799\ud2b8\uac00 \uc57d\uc18d\uc744 \ud1b5\ud574 \uc790\uccb4\uc801\uc73c\ub85c \uba54\uc11c\ub4dc\ub97c \ud638\ucd9c\ud560 \uc218 \uc788\ub3c4\ub85d \uc77c\ubd80 \uba54\uc11c\ub4dc\ub97c \ub178\ucd9c\ud574\uc57c \ud558\uc9c0\ub9cc, \ub2e4\ub978 \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c \ud638\ucd9c\ud558\ub294 \uac83\uc740 \ud5c8\uc6a9\ud558\uc9c0 \uc54a\uc73c\ub824\uace0 \ud569\ub2c8\ub2e4. \uc774\ub97c \uc704\ud574 ",(0,r.jsx)(n.code,{children:"#[private]"})," \uc8fc\uc11d\uc744 \uc0ac\uc6a9\ud558\uc5ec, \uc774 \uba54\uc11c\ub4dc\uac00 \uc678\ubd80\uc5d0\uc11c \ud638\ucd9c\ub420 \ub54c \ud328\ub2c9\ud558\ub3c4\ub85d \ud569\ub2c8\ub2e4. \uc790\uc138\ud55c \ub0b4\uc6a9\uc740 ",(0,r.jsx)(n.a,{href:"/ko/sdk/rust/contract-interface/private-methods",children:"\ud504\ub77c\uc774\ube57 \uba54\uc11c\ub4dc"}),"\ub97c \ucc38\uc870\ud558\uc138\uc694."]}),"\n",(0,r.jsx)(n.p,{children:"\uc774 \uc8fc\uc11d\uc740 \ub2e4\uc74c\uc744 \ud1b5\ud574 \ubaa8\ub4e0 \uba54\uc11c\ub4dc\uc5d0 \uc801\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"#[private]\npub fn my_method(&mut self) {\n...\n}\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"Interaction with other macros",type:"info",children:(0,r.jsxs)(n.p,{children:["When ",(0,r.jsx)(n.code,{children:"near"})," is built for the wasm32 target, it generates the external NEAR contract bindings.  To achieve this it is actually generating another function with the signature ",(0,r.jsx)(n.code,{children:'pub extern "C" fn function_name()'})," that first deserializes the contract struct from NEAR storage and then calls the ",(0,r.jsx)(n.code,{children:"contract.function_name(parameter1, parameter2, ...)"}),".  If you have annotated your function with any attribute-like macros, these are then executed ",(0,r.jsx)(n.em,{children:"twice"}),".  Specifically if the attribute like macro makes any modification to the function signature, or inserts any code that depends on the contract struct (in the form of ",(0,r.jsx)(n.code,{children:"&self"}),", ",(0,r.jsx)(n.code,{children:"&mut self"}),", or ",(0,r.jsx)(n.code,{children:"self"}),") this will fail in the second invocation, because the externally exposed function does not have any concept of this struct.  It is possible to detect this by checking which build target you are building for and limit the execution of the macro to operate only on the first pass."]})})]})}function u(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>i});var r=t(67294);const s={},c=r.createContext(s);function i(e){const n=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);