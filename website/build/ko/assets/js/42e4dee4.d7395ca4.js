"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8202],{49888:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>c,toc:()=>d});var r=t(85893),a=t(11151),s=t(74866),i=t(85162);const l={id:"cache",title:"Cache"},o=void 0,c={id:"bos/api/cache",title:"Cache",description:"The VM implements caching layer for most network requests. You can leverage it manually by using useCache hook.",source:"@site/../docs/bos/api/cache.md",sourceDirName:"bos/api",slug:"/bos/api/cache",permalink:"/ko/bos/api/cache",draft:!1,unlisted:!1,editUrl:"https://github.com/near/docs/edit/master/website/../docs/bos/api/cache.md",tags:[],version:"current",lastUpdatedBy:"gagdiez",lastUpdatedAt:1702155614,formattedLastUpdatedAt:"2023\ub144 12\uc6d4 9\uc77c",frontMatter:{id:"cache",title:"Cache"},sidebar:"integrate",previous:{title:"Primitives",permalink:"/ko/bos/api/primitives"},next:{title:"Clipboard",permalink:"/ko/bos/api/clipboard"}},u={},d=[{value:"useCache",id:"usecache",level:2},{value:"Examples",id:"examples",level:3}];function h(e){const n={admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["The VM implements caching layer for most network requests. You can leverage it manually by using ",(0,r.jsx)(n.code,{children:"useCache"})," hook."]}),"\n",(0,r.jsx)(n.h2,{id:"usecache",children:"useCache"}),"\n",(0,r.jsxs)(n.p,{children:["The method acts like a hook that takes a promise through a generator function, fetches the data and caches it. The cache is global for the VM, but it's identified by for given component (by src) for a given ",(0,r.jsx)(n.code,{children:"dataKey"}),".\nIt can be used to easily use and cache data from async data sources."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Returns"})," ",(0,r.jsx)(n.code,{children:"null"})," if the cache is cold and data is fetching, or the previous cached value while the data is being fetched an d, or the new data if the new promise data is different from the old data."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"The data is being cached and compared as JSON serialized objects."})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"param"}),(0,r.jsx)(n.th,{children:"required"}),(0,r.jsx)(n.th,{children:"type"}),(0,r.jsx)(n.th,{children:"description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"promiseGenerator"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"required"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"a function that returns a promise, which generates data."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"dataKey"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"required"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"the unique name (within the current component) to identify the data."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"options"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.em,{children:"optional"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"optional argument."})]})]})]}),"\n",(0,r.jsx)(n.admonition,{title:"options object",type:"info",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"subscribe"})," ",(0,r.jsx)(n.em,{children:"(optional)"}),": if ",(0,r.jsx)(n.code,{children:"true"}),", the data refreshes periodically by invalidating cache."]}),"\n"]})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"promiseGenerator"}),": you don't return the promise directly, because it should only be fired once."]}),"\n"]})}),"\n",(0,r.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(i.Z,{value:"request",label:"Request",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'const status = useCache(\n  () =>\n    asyncFetch("https://rpc.mainnet.near.org/status").then((res) => res.body),\n  "mainnetRpcStatus",\n  { subscribe: true }\n);\n\nreturn status;\n'})})}),(0,r.jsx)(i.Z,{value:"response",label:"Response",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "version": {\n    "version": "1.31.1",\n    "build": "1.31.1",\n    "rustc_version": "1.65.0"\n  },\n  "chain_id": "mainnet",\n  "protocol_version": 58,\n  "latest_protocol_version": 58,\n  "rpc_addr": "127.0.0.1:4040",\n  "validators": [\n    {\n      "account_id": "figment.poolv1.near",\n      "is_slashed": false\n    },\n    {\n      "account_id": "staked.poolv1.near",\n      "is_slashed": false\n    },\n    {\n      "account_id": "galaxydigital.poolv1.near",\n      "is_slashed": false\n    }\n  ],\n  "sync_info": {\n    "latest_block_hash": "ArPXejJYcFEDtU8Ma7tXFPM1pRDDzDSkj1KVBjphVwnw",\n    "latest_block_height": 85795851,\n    "latest_state_root": "EXhYFzPLdno6ZNHFr7DSGFWqUSZLSVZj6oP15xUdrmMm",\n    "latest_block_time": "2023-02-22T13:48:47.342467480Z",\n    "syncing": false,\n    "earliest_block_hash": "HTrKnWapTNuZwoAeeepeV3deyQcJNg1CeKg4PPR8n9Ah",\n    "earliest_block_height": 85593094,\n    "earliest_block_time": "2023-02-19T18:54:15.505365092Z",\n    "epoch_id": "H99thh9tGD8kBwJC5fac83TYGs6W2TTq1Xv3Jqw2VWYv",\n    "epoch_start_height": 85765895\n  },\n  "validator_account_id": null,\n  "validator_public_key": null,\n  "node_public_key": "ed25519:BhqHCszVngV2MqJrTVjtcbWNGuLUyqXcXyBuCUt8DK9k",\n  "node_key": null,\n  "uptime_sec": 505796\n}\n'})})})]})]})}function p(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},85162:(e,n,t)=>{t.d(n,{Z:()=>i});t(67294);var r=t(36905);const a={tabItem:"tabItem_Ymn6"};var s=t(85893);function i(e){var n=e.children,t=e.hidden,i=e.className;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.Z)(a.tabItem,i),hidden:t,children:n})}},74866:(e,n,t)=>{t.d(n,{Z:()=>_});var r=t(67294),a=t(36905),s=t(12466),i=t(16550),l=t(20469),o=t(91980),c=t(67392),u=t(50012);function d(e){var n,t;return null!=(n=null==(t=r.Children.toArray(e).filter((function(e){return"\n"!==e})).map((function(e){if(!e||(0,r.isValidElement)(e)&&((n=e.props)&&"object"==typeof n&&"value"in n))return e;var n;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:t.filter(Boolean))?n:[]}function h(e){var n=e.values,t=e.children;return(0,r.useMemo)((function(){var e=null!=n?n:function(e){return d(e).map((function(e){var n=e.props;return{value:n.value,label:n.label,attributes:n.attributes,default:n.default}}))}(t);return function(e){var n=(0,c.l)(e,(function(e,n){return e.value===n.value}));if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[n,t])}function p(e){var n=e.value;return e.tabValues.some((function(e){return e.value===n}))}function f(e){var n=e.queryString,t=void 0!==n&&n,a=e.groupId,s=(0,i.k6)(),l=function(e){var n=e.queryString,t=void 0!==n&&n,r=e.groupId;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=r?r:null}({queryString:t,groupId:a});return[(0,o._X)(l),(0,r.useCallback)((function(e){if(l){var n=new URLSearchParams(s.location.search);n.set(l,e),s.replace(Object.assign({},s.location,{search:n.toString()}))}}),[l,s])]}function b(e){var n,t,a,s,i=e.defaultValue,o=e.queryString,c=void 0!==o&&o,d=e.groupId,b=h(e),m=(0,r.useState)((function(){return function(e){var n,t=e.defaultValue,r=e.tabValues;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:r}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+r.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}var a=null!=(n=r.find((function(e){return e.default})))?n:r[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:i,tabValues:b})})),v=m[0],j=m[1],x=f({queryString:c,groupId:d}),g=x[0],y=x[1],_=(n=function(e){return e?"docusaurus.tab."+e:null}({groupId:d}.groupId),t=(0,u.Nk)(n),a=t[0],s=t[1],[a,(0,r.useCallback)((function(e){n&&s.set(e)}),[n,s])]),k=_[0],w=_[1],V=function(){var e=null!=g?g:k;return p({value:e,tabValues:b})?e:null}();return(0,l.Z)((function(){V&&j(V)}),[V]),{selectedValue:v,selectValue:(0,r.useCallback)((function(e){if(!p({value:e,tabValues:b}))throw new Error("Can't select invalid tab value="+e);j(e),y(e),w(e)}),[y,w,b]),tabValues:b}}var m=t(72389);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=t(85893);function x(e){var n=e.className,t=e.block,r=e.selectedValue,i=e.selectValue,l=e.tabValues,o=[],c=(0,s.o5)().blockElementScrollPositionUntilNextRender,u=function(e){var n=e.currentTarget,t=o.indexOf(n),a=l[t].value;a!==r&&(c(n),i(a))},d=function(e){var n,t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":var r,a=o.indexOf(e.currentTarget)+1;t=null!=(r=o[a])?r:o[0];break;case"ArrowLeft":var s,i=o.indexOf(e.currentTarget)-1;t=null!=(s=o[i])?s:o[o.length-1]}null==(n=t)||n.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":t},n),children:l.map((function(e){var n=e.value,t=e.label,s=e.attributes;return(0,j.jsx)("li",Object.assign({role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:function(e){return o.push(e)},onKeyDown:d,onClick:u},s,{className:(0,a.Z)("tabs__item",v.tabItem,null==s?void 0:s.className,{"tabs__item--active":r===n}),children:null!=t?t:n}),n)}))})}function g(e){var n=e.lazy,t=e.children,a=e.selectedValue,s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){var i=s.find((function(e){return e.props.value===a}));return i?(0,r.cloneElement)(i,{className:"margin-top--md"}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:s.map((function(e,n){return(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==a})}))})}function y(e){var n=b(e);return(0,j.jsxs)("div",{className:(0,a.Z)("tabs-container",v.tabList),children:[(0,j.jsx)(x,Object.assign({},e,n)),(0,j.jsx)(g,Object.assign({},e,n))]})}function _(e){var n=(0,m.Z)();return(0,j.jsx)(y,Object.assign({},e,{children:d(e.children)}),String(n))}},11151:(e,n,t)=>{t.d(n,{Z:()=>l,a:()=>i});var r=t(67294);const a={},s=r.createContext(a);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);