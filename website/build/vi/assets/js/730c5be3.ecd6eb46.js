"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4741],{78771:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>r,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>h,toc:()=>o});var c=t(85893),s=t(11151);const i={id:"gas-advanced",title:"Gas - Advanced"},a=void 0,h={id:"concepts/basics/transactions/gas-advanced",title:"Gas - Advanced",description:"Chi ph\xed c\u1ee7a nh\u1eefng thao t\xe1c ph\u1ee9c t\u1ea1p",source:"@site/i18n/vi/docusaurus-plugin-content-docs/current/1.concepts/basics/transactions/gas-advanced.md",sourceDirName:"1.concepts/basics/transactions",slug:"/concepts/basics/transactions/gas-advanced",permalink:"/vi/concepts/basics/transactions/gas-advanced",draft:!1,unlisted:!1,editUrl:"https://github.com/near/docs/edit/master/website/../docs/1.concepts/basics/transactions/gas-advanced.md",tags:[],version:"current",lastUpdatedBy:"Github Actions",lastUpdatedAt:1704996595,formattedLastUpdatedAt:"11 thg 1, 2024",frontMatter:{id:"gas-advanced",title:"Gas - Advanced"},sidebar:"concepts",previous:{title:"Gas",permalink:"/vi/concepts/basics/transactions/gas"},next:{title:"NEAR Data Flow",permalink:"/vi/concepts/data-flow/near-data-flow"}},r={},o=[{value:"Chi ph\xed c\u1ee7a nh\u1eefng thao t\xe1c ph\u1ee9c t\u1ea1p",id:"costs-of-complex-actions",level:2},{value:"Deploying Contract",id:"deploying-contracts",level:3},{value:"Function call",id:"function-calls",level:3},{value:"Ballpark Comparison v\u1edbi Ethereum",id:"ballpark-comparisons-to-ethereum",level:4},{value:"Estimating Gas Costs with Automated Tests",id:"accurate-estimates-with-automated-tests",level:4},{value:"Gas Cost Estimation in the SDK",id:"gas-cost-estimation-in-the-sdk",level:4},{value:"Pessimistic gas price inflation",id:"pessimistic-gas-price-inflation",level:2},{value:"Gas price b\xe2y gi\u1edd l\xe0 bao nhi\xeau?",id:"whats-the-price-of-gas-right-now",level:2},{value:"M\u1ed9t v\xe0i k\u1ebft lu\u1eadn t\u1eeb whitepaper",id:"some-closing-thoughts-from-the-whitepaper",level:2}];function l(n){const e={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.h2,{id:"costs-of-complex-actions",children:"Chi ph\xed c\u1ee7a nh\u1eefng thao t\xe1c ph\u1ee9c t\u1ea1p"}),"\n",(0,c.jsx)(e.p,{children:"Ch\xfang ta h\xe3y n\xf3i v\u1ec1 vi\u1ec7c t\xednh to\xe1n m\u1ed9t s\u1ed1 ph\xed gas ph\u1ee9c t\u1ea1p h\u01a1n nh\u01b0: deploying contract v\xe0 function call."}),"\n",(0,c.jsx)(e.h3,{id:"deploying-contracts",children:"Deploying Contract"}),"\n",(0,c.jsx)(e.p,{children:"The basic action cost includes two different values for deploying contracts. \u0110\u01a1n gi\u1ea3n, \u0111\xf3 l\xe0:"}),"\n",(0,c.jsx)(e.p,{children:"deploy_contract_cost: 184765750000,\ndeploy_contract_cost_per_byte: 64572944,"}),"\n",(0,c.jsxs)(e.p,{children:["These values can be queried by using the ",(0,c.jsx)(e.a,{href:"/api/rpc/protocol#protocol-config",children:(0,c.jsx)(e.code,{children:"protocol_config"})})," RPC endpoint."]}),"\n",(0,c.jsxs)(e.p,{children:["\u0110\u1ea7u ti\xean l\xe0 chi ph\xed c\u01a1 b\u1ea3n, n\xf3 kh\xf4ng ph\u1ee5 thu\u1ed9c v\xe0o k\xedch th\u01b0\u1edbc c\u1ee7a contract. Keeping in mind that each need to be multiplied by two, for both ",(0,c.jsx)(e.code,{children:"send"})," and ",(0,c.jsx)(e.code,{children:"execute"})," costs, and will also require sending & executing a receipt, the gas units comes to:"]}),"\n",(0,c.jsx)(e.p,{children:"2 * 184765750000 +\n2 * contract_size_in_bytes * 64572944 +\n2 * 108059500000"}),"\n",(0,c.jsx)(e.p,{children:"(Chia k\u1ebft qu\u1ea3 cho 10\xb9\xb2 \u0111\u1ec3 \u0111\u1ed5i ra TGas!)"}),"\n",(0,c.jsxs)(e.p,{children:["Note that this covers the cost of uploading and writing bytes to storage, but does ",(0,c.jsx)(e.strong,{children:"not"})," cover the cost of holding these bytes in storage. Long-term storage is compensated via storage staking, a recoverable cost-per-byte amount that will also be deducted from your account during contract deployment."]}),"\n",(0,c.jsxs)(e.p,{children:["Deploying a 16kb contract requires ",(0,c.jsx)(e.strong,{children:"2.65 TGas"})," (and thus 0.265mN at minimum gas price) for the transaction fee, while 1.5N will be locked up for storage staking."]}),"\n",(0,c.jsx)(e.h3,{id:"function-calls",children:"Function call"}),"\n",(0,c.jsx)(e.p,{children:"V\u1edbi b\u1ea3n ch\u1ea5t m\u1ee5c \u0111\xedch chung c\u1ee7a NEAR, c\xe1c function call d\xe0nh \u0111\u01b0\u1ee3c ph\u1ea7n th\u1eafng cho c\xe1c t\xednh to\xe1n gas ph\u1ee9c t\u1ea1p nh\u1ea5t. M\u1ed9t function call nh\u1ea5t \u0111\u1ecbnh s\u1ebd s\u1eed d\u1ee5ng m\u1ed9t l\u01b0\u1ee3ng CPU, network v\xe0 IO r\u1ea5t kh\xf3 \u0111\u1ec3 d\u1ef1 \u0111o\xe1n. S\u1ed1 l\u01b0\u1ee3ng c\u1ee7a m\u1ed7i lo\u1ea1i th\u1eadm ch\xed c\xf3 th\u1ec3 thay \u0111\u1ed5i d\u1ef1a tr\xean l\u01b0\u1ee3ng d\u1eef li\u1ec7u \u0111\xe3 \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef trong contract!"}),"\n",(0,c.jsxs)(e.p,{children:["V\u1edbi m\u1ee9c \u0111\u1ed9 ph\u1ee9c t\u1ea1p n\xe0y, s\u1ebd kh\xf4ng c\xf3 nhi\u1ec1u l\u1ee3i \xedch khi xem qua m\u1ed9t v\xed d\u1ee5, li\u1ec7t k\xea (h\xe3y nh\xecn ",(0,c.jsx)(e.code,{children:"ext_costs"})," b\xean d\u01b0\u1edbi ",(0,c.jsx)(e.code,{children:"wasm_config"})," b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng ",(0,c.jsx)(e.a,{href:"/api/rpc/protocol#protocol-config",children:(0,c.jsx)(e.code,{children:"protocol_config"})})," RPC endpoint) c\xe1c ph\xe9p t\xednh gas (b\u1ea1n c\xf3 th\u1ec3 t\u1ef1 nghi\xean c\u1ee9u \u0111i\u1ec1u n\xe0y ",(0,c.jsx)(e.a,{href:"https://github.com/near/nearcore/pull/3038",children:"n\u1ebfu b\u1ea1n mu\u1ed1n"}),"). Thay v\xe0o \u0111\xf3, h\xe3y ti\u1ebfp c\u1eadn t\u1eeb hai g\xf3c \u0111\u1ed9 kh\xe1c nhau: so s\xe1nh ballpark comparison v\u1edbi Ethereum v\xe0 nh\u1eadn c\xe1c \u01b0\u1edbc t\xednh ch\xednh x\xe1c v\u1edbi c\xe1c b\xe0i automated test."]}),"\n",(0,c.jsxs)("blockquote",{class:"lesson",children:[(0,c.jsx)(e.p,{children:(0,c.jsx)(e.strong,{children:"How much of the gas fee goes as a 30% reward to the smart contract account?"})}),(0,c.jsxs)(e.p,{children:["The NEAR Whitepaper mentions that ",(0,c.jsx)(e.a,{href:"https://near.org/papers/the-official-near-white-paper/",children:"30% of all gas fees"})," go to smart contract accounts on which the fees are expensed."]}),(0,c.jsx)(e.p,{children:"This amount can be calculated for function calls in two ways:"}),(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsx)(e.li,{children:"Summing all values in the gas profile"}),"\n",(0,c.jsxs)(e.li,{children:["Taking the total gas burnt for the transaction and subtract the static execution gas (which is equal to the amount of gas spent on sending the receipt(s)) from it. Both these numbers are available on the ",(0,c.jsx)(e.a,{href:"https://nearblocks.io/",children:"NEAR Explorer"})," overview page for a transaction."]}),"\n"]}),(0,c.jsx)(e.p,{children:"The second approach is shorter, and quite possibly easier to remember. So here's an example:"}),(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["An account calls the method ",(0,c.jsx)(e.code,{children:"submit"})," on ",(0,c.jsx)(e.code,{children:"aurora"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"Converting the transaction to receipt burned a total of ~0.00024\u24c3"}),"\n",(0,c.jsx)(e.li,{children:"Executing the receipt burned a total of ~0.00376\u24c3"}),"\n"]}),"\n"]}),"\n"]}),(0,c.jsx)(e.p,{children:"The 30% reward for the smart contract owner (in this case aurora) would be: (0.00376\u24c3 - 0.00024\u24c3) * 0.3 = 0.001056\u24c3"}),(0,c.jsxs)(e.p,{children:["This transaction can also be found ",(0,c.jsx)(e.a,{href:"https://nearblocks.io/txns/GzRn9yhDaQ8f3ReJguCBGxdi4iJEeBguJ5MWufMcu1JP",children:"here"})," on NEAR Explorer, feel free to have a look around!"]}),(0,c.jsx)(e.p,{children:"For calls involving multiple contracts, calculating the reward for each contract with this method would not be possible with the data shown on NEAR Explorer (June 2022) as the explorer does not show the conversion cost for the second (and other) receipt(s)."})]}),"\n",(0,c.jsx)(e.h4,{id:"ballpark-comparisons-to-ethereum",children:"Ballpark Comparison v\u1edbi Ethereum"}),"\n",(0,c.jsx)(e.p,{children:"Gi\u1ed1ng nh\u01b0 NEAR, Ethereum s\u1eed d\u1ee5ng c\xe1c gas unit \u0111\u1ec3 m\xf4 h\xecnh h\xf3a \u0111\u1ed9 ph\u1ee9c t\xednh to\xe1n c\u1ee7a m\u1ed9t ho\u1ea1t \u0111\u1ed9ng. Nh\u01b0ng kh\xe1c \u1edf ch\u1ed7, thay v\xec s\u1eed d\u1ee5ng gas price c\xf3 th\u1ec3 d\u1ef1 \u0111o\xe1n \u0111\u01b0\u1ee3c, Ethereum s\u1eed d\u1ee5ng m\u1ed9t marketplace \u0111\u1ed9ng, d\u1ef1a tr\xean vi\u1ec7c \u0111\u1ea5u gi\xe1. \u0110i\u1ec1u n\xe0y l\xe0m cho vi\u1ec7c so s\xe1nh v\u1edbi gas price c\u1ee7a Ethereum v\xe0 NEAR h\u01a1i ph\u1ee9c t\u1ea1p, nh\u01b0ng ch\xfang ta s\u1ebd c\u1ed1 g\u1eafng h\u1ebft s\u1ee9c."}),"\n",(0,c.jsxs)(e.p,{children:["Etherscan cung c\u1ea5p ",(0,c.jsx)(e.a,{href:"https://etherscan.io/chart/gasprice",children:"bi\u1ec3u \u0111\u1ed3 l\u1ecbch s\u1eed gas price c\u1ee7a Ethereum"}),'. C\xe1c m\u1ee9c gi\xe1 n\xe0y \u0111\u01b0\u1ee3c t\xednh b\u1eb1ng "Gwei" ho\u1eb7c Gigawei, trong \u0111\xf3 wei l\xe0 s\u1ed1 l\u01b0\u1ee3ng ETH nh\u1ecf nh\u1ea5t c\xf3 th\u1ec3, gi\xe1 tr\u1ecb c\u1ee7a n\xf3 l\xe0 10\u207b\xb9\u2078 ETH. T\u1eeb th\xe1ng 11/2017 \u0111\u1ebfn th\xe1ng 07/2020, trung b\xecnh gas price l\xe0 21Gwei. H\xe3y g\u1ecdi \u0111\xe2y l\xe0 chi ph\xed "average" gas price. V\xe0o th\xe1ng 07/2020, chi ph\xed average gas price \u0111\xe3 t\u0103ng l\xean 57Gwei. L\u1ea5y con s\u1ed1 n\xe0y l\xe0m "high" gas fee c\u1ee7a Ethereum.']}),"\n",(0,c.jsx)(e.p,{children:'B\u1eb1ng c\xe1ch nh\xe2n gas unit c\u1ee7a Ethereum v\u1edbi gas price \u0111\u1ec3 t\xednh \u0111\u01b0\u1ee3c chi ph\xed \u0111\u01b0\u1ee3c t\xednh b\u1eb1ng milliETH (mE), gi\u1ed1ng nh\u01b0 c\xe1ch ch\xfang ta \u0111\xe3 chuy\u1ec3n \u0111\u1ed5i TGas th\xe0nh milliNEAR v\u1edbi NEAR. H\xe3y xem m\u1ed9t s\u1ed1 h\xe0nh \u0111\u1ed9ng ph\u1ed5 bi\u1ebfn, v\xe0 so s\xe1nh gas units c\u1ee7a Ethereum v\u1edbi NEAR, c\u0169ng nh\u01b0 c\xe1c gi\xe1 tr\u1ecb "average" & "high" m\xe0 ch\xfang ta \u0111\xe3 \u0111\u1ec1 c\u1eadp \u1edf tr\xean.'}),"\n",(0,c.jsxs)(e.table,{children:[(0,c.jsx)(e.thead,{children:(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.th,{children:"Operation"}),(0,c.jsx)(e.th,{children:"ETH gas units"}),(0,c.jsx)(e.th,{children:"avg mE"}),(0,c.jsx)(e.th,{children:"high mE"}),(0,c.jsx)(e.th,{children:"NEAR TGas"}),(0,c.jsx)(e.th,{children:"mN"})]})}),(0,c.jsxs)(e.tbody,{children:[(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:"Transfer native token (ETH or NEAR)"}),(0,c.jsx)(e.td,{children:"21k"}),(0,c.jsx)(e.td,{children:"0.441"}),(0,c.jsx)(e.td,{children:"1.197"}),(0,c.jsx)(e.td,{children:"0.45"}),(0,c.jsx)(e.td,{children:"0.045"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsxs)(e.td,{children:["Deploy & initialize a ",(0,c.jsx)(e.a,{href:"https://github.com/near-examples/FT/pull/42",children:"fungible token"})," contract"]}),(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/chadoh/erc20-test",children:"1.1M"})}),(0,c.jsx)(e.td,{children:"23.3"}),(0,c.jsx)(e.td,{children:"63.1"}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.a,{href:"https://testnet.nearblocks.io/txns/GsgH2KoxLZoL8eoutM2NkHe5tBPnRfyhcDMZaBEsC7Sm",children:"9"}),(0,c.jsx)("super",{children:"\u2020"})]}),(0,c.jsxs)(e.td,{children:["0.9 (plus 1.5\u24c3 in ",(0,c.jsx)(e.a,{href:"/docs/concepts/storage-staking",children:"storage staking"}),")"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:"Transfer a fungible token"}),(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://ethereum.stackexchange.com/questions/71235/gas-limit-for-erc-20-tokens",children:"~45k"})}),(0,c.jsx)(e.td,{children:"0.945"}),(0,c.jsx)(e.td,{children:"2.565"}),(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://testnet.nearblocks.io/txns/5joKRvsmpEXzhVShsPDdV8z5EG9bGMWeuM9e9apLJhLe",children:"14"})}),(0,c.jsx)(e.td,{children:"1.4"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:"Setting an escrow for a fungible token"}),(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/chadoh/erc20-test",children:"44k"})}),(0,c.jsx)(e.td,{children:"0.926"}),(0,c.jsx)(e.td,{children:"2.51"}),(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://testnet.nearblocks.io/txns/34pW67zsotFsD1DY8GktNhZT9yP5KHHeWAmhKaYvvma6",children:"8"})}),(0,c.jsx)(e.td,{children:"0.8"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:"Checking a balance for a fungible token"}),(0,c.jsx)(e.td,{children:"0"}),(0,c.jsx)(e.td,{children:"0"}),(0,c.jsx)(e.td,{children:"0"}),(0,c.jsx)(e.td,{children:"0"}),(0,c.jsx)(e.td,{children:"0"})]})]})]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)("super",{children:"\u2020"})," Nh\u1eefng function call y\xeau c\u1ea7u kh\u1edfi \u0111\u1ed9ng m\u1ed9t VM v\xe0 t\u1ea3i t\u1ea5t c\u1ea3 c\xe1c byte m\xe0 Wasm \u0111\xe3 bi\xean d\u1ecbch v\xe0o b\u1ed9 nh\u1edb, do \u0111\xf3 chi ph\xed t\u0103ng l\xean so v\u1edbi c\xe1c thao t\xe1c c\u01a1 b\u1ea3n, c\xf3 th\u1ec3 xem th\xeam v\u1ec1 ch\u1ee7 \u0111\u1ec1 ",(0,c.jsx)(e.a,{href:"https://github.com/near/nearcore/issues/3094",children:"t\u1ed1i \u01b0u h\xf3a chi ph\xed cho function call"}),"."]}),"\n",(0,c.jsx)(e.p,{children:"Trong c\xe1c ho\u1ea1t \u0111\u1ed9ng, n\u1ebfu nh\xecn qua ch\xfang ta ch\u1ec9 th\u1ea5y NEAR \u0111\u01b0\u1ee3c c\u1ea3i thi\u1ec7n kho\u1ea3ng 10 l\u1ea7n so v\u1edbi Ethereum, nh\u01b0ng th\xeam m\u1ed9t \u0111i\u1ec1u c\u1ea7n l\u01b0u \xfd l\xe0 t\u1ed5ng ngu\u1ed3n cung c\u1ee7a NEAR l\xe0 h\u01a1n 1 t\u1ef7, trong khi \u0111\xf3 t\u1ed5ng cung c\u1ee7a Ethereum l\xe0 h\u01a1n 100 tri\u1ec7u. V\xec v\u1eady, t\u01b0\u01a1ng \u1ee9ng v\u1edbi t\u1ed5ng ngu\u1ed3n cung, gas fee c\u1ee7a NEAR c\u0169ng th\u1ea5p h\u01a1n kho\u1ea3ng 10 l\u1ea7n so v\u1edbi Ethereum. Ngo\xe0i ra, n\u1ebfu gi\xe1 NEAR t\u0103ng l\xean m\u1ed9t c\xe1ch \u0111\xe1ng k\u1ec3, th\xec ph\xed gas t\u1ed1i thi\u1ec3u do NEAR network \u0111\u1eb7t ra c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c h\u1ea1 xu\u1ed1ng."}),"\n",(0,c.jsxs)(e.p,{children:["B\u1ea1n c\xf3 th\u1ec3 mong \u0111\u1ee3i network lu\xf4n \u1edf m\u1ee9c gas price t\u1ed1i thi\u1ec3u, t\xecm hi\u1ec3u th\xeam \u1edf ",(0,c.jsx)(e.a,{href:"https://near.org/papers/economics-in-sharded-blockchain/#transaction-and-storage-fees",children:"Economics whitepaper"}),"."]}),"\n",(0,c.jsx)(e.h4,{id:"accurate-estimates-with-automated-tests",children:"Estimating Gas Costs with Automated Tests"}),"\n",(0,c.jsxs)(e.p,{children:["Gas unit expense for running smart contract functions can be accurately estimated by running these in ",(0,c.jsx)(e.code,{children:"testnet"}),". Generally, ",(0,c.jsx)(e.code,{children:"testnet"})," runs a higher version of the protocol than ",(0,c.jsx)(e.code,{children:"mainnet"}),". However, gas expense calculations do not change often making this is a good way to get a sense of how much gas a function will cost on ",(0,c.jsx)(e.code,{children:"mainnet"}),"."]}),"\n",(0,c.jsxs)(e.p,{children:["To estimate gas costs, you can use the ",(0,c.jsx)(e.code,{children:"near-workspaces"})," ",(0,c.jsx)(e.a,{href:"https://github.com/near/workspaces-rs/tree/main/examples/src",children:"crate in Rust"})," or similarly named ",(0,c.jsx)(e.a,{href:"https://github.com/near/workspaces-js",children:"package in JavaScript"}),"."]}),"\n",(0,c.jsxs)(e.p,{children:["You may extract the ",(0,c.jsx)(e.code,{children:"total_gas_burnt"})," field from the ",(0,c.jsx)(e.code,{children:"CallExecutionDetails"})," struct returned by the ",(0,c.jsx)(e.code,{children:"call"})," method. (",(0,c.jsx)(e.a,{href:"/vi/sdk/rust/testing/integration-tests#profiling-gas",children:"Read more"}),")"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-rust",children:'println!("Burnt gas (all): {}", res.total_gas_burnt);\n'})}),"\n",(0,c.jsxs)(e.p,{children:["In JS, you can calculate this value by adding ",(0,c.jsx)(e.code,{children:"result.receipts_outcome[0].outcome.gas_burnt"})," with the amount of gas units consumed for receipt execution in ",(0,c.jsx)(e.code,{children:"result.transaction_outcome.outcome.gas_burnt"}),"."]}),"\n",(0,c.jsxs)(e.admonition,{title:"Gas Cost Estimation REST API",type:"info",children:[(0,c.jsxs)(e.p,{children:["You may obtain gas cost estimates for a given function call using ",(0,c.jsx)(e.code,{children:"api.gasbuddy.tech"}),". This API is experimental and may be removed in the future. One can obtain a gas cost estimate for a given function call by sending a POST request to ",(0,c.jsx)(e.code,{children:"https://api.gasbuddy.tech/profile"})," with the following JSON body:"]}),(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "contract_id": "<your-contract-account-id>",\n  "method": "<your-contract-method-name>",\n  "args": {\n    "arg1": "value1",\n    "arg2": "value2"\n  }\n}\n'})})]}),"\n",(0,c.jsx)(e.h4,{id:"gas-cost-estimation-in-the-sdk",children:"Gas Cost Estimation in the SDK"}),"\n",(0,c.jsxs)(e.p,{children:["Our ",(0,c.jsx)(e.a,{href:"/vi/develop/contracts/environment/",children:"SDK environment"})," exposes the ",(0,c.jsx)(e.code,{children:"used gas"})," method, which lets you know how much gas was used so far."]}),"\n",(0,c.jsx)(e.p,{children:"You can benchmark how much gas a method (or a portion) uses by simply computing the difference in gas used between two points:"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-ts",children:'function myMethod(){\n  // take gas usage\n  const used_gas_point_A = environment.used_gas()\n\n  // --- some code goes here ---\n\n  const used_gas_point_B = environment.used_gas()\n\n  log("Used gas", used_gas_point_B - used_gas_point_A )\n}\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"pessimistic-gas-price-inflation",children:"Pessimistic gas price inflation"}),"\n",(0,c.jsxs)(e.p,{children:["A transactions may take several blocks before it completes. Due to dynamic gas price adjustments, later blocks may have a higher gas price than when the transaction was signed. To guarantee that the transaction can still finish, the amount of tokens reserved when starting a transaction is increased by the ",(0,c.jsx)(e.em,{children:"pessimistic-inflation rule"}),"."]}),"\n",(0,c.jsx)(e.p,{children:"The pessimistic inflation rule means that the gas has to be purchased at the highest theoretical gas price that the transaction could reach. The extra spending is only temporary, the difference between the pessimistic and actual price is refunded when the transaction finishes. This is the reason why in the explorer, virtually every transaction that spans more than one block contains a refund, even if all the gas has been spent."}),"\n",(0,c.jsx)(e.p,{children:"By how much is the price inflated? It depends on how many blocks a transaction may take. A simple transaction that only sends tokens from one account to another can take between 2-3 blocks."}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"One block to subtract the money from the signer's account"}),"\n",(0,c.jsx)(e.li,{children:"One block to add it to the receivers account"}),"\n",(0,c.jsx)(e.li,{children:"Potentially another block if the receiver is on another shard and the receipt application gets delayed."}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:["Therefore, the pessimistically inflated price is increased by 3% or calculated as ",(0,c.jsx)(e.code,{children:"gas_price"})," \u2a09 1.03. Every additional cross-shard communication adds another factor of 1.03."]}),"\n",(0,c.jsx)(e.p,{children:"For a function call, the maximum block delay is computed as the total gas attached divided by the minimum amount required to call another function. Therefore, the more gas you attach to a transaction, the higher your gas price. But again, the increased price is temporarily and will be refunded unless the network actually becomes that congested. Prices would have to go up by the maximum every block and your receipts would need to be very unlucky to have extra delays every time."}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"whats-the-price-of-gas-right-now",children:"Gas price b\xe2y gi\u1edd l\xe0 bao nhi\xeau?"}),"\n",(0,c.jsxs)(e.p,{children:["B\u1ea1n c\xf3 th\u1ec3 truy v\u1ea5n tr\u1ef1c ti\u1ebfp NEAR platform v\u1ec1 gas price tr\xean m\u1ed9t block c\u1ee5 th\u1ec3 b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng RPC method ",(0,c.jsx)(e.code,{children:"gas_price"}),". Gi\xe1 n\xe0y c\xf3 th\u1ec3 thay \u0111\u1ed5i d\u1ef1a v\xe0o network load. N\xf3 \u0111\u01b0\u1ee3c t\xednh b\u1eb1ng yoctoNEAR (10^-24 NEAR)"]}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Take any recent block hash from the blockchain using ",(0,c.jsx)(e.a,{href:"https://testnet.nearblocks.io/blocks",children:"NearBlocks Explorer"})]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsxs)(e.em,{children:["T\u1ea1i th\u1eddi \u0111i\u1ec3m vi\u1ebft b\xe0i n\xe0y, ",(0,c.jsx)(e.code,{children:"SqNPYxdgspCT3dXK93uVvYZh18yPmekirUaXpoXshHv"})," l\xe0 block hash cu\u1ed1i c\xf9ng"]})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["G\u1eedi m\u1ed9t y\xeau c\u1ea7u t\u1edbi RPC \u0111\u1ec3 xem gas price tr\xean block n\xe0y s\u1eed d\u1ee5ng method ",(0,c.jsx)(e.code,{children:"gas_price"})," ",(0,c.jsx)(e.a,{href:"/api/rpc/gas#gas-price",children:"xem t\xe0i li\u1ec7u \u1edf \u0111\xe2y"})]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"http post https://rpc.testnet.near.org jsonrpc=2.0 method=gas_price params:='[\"SqNPYxdgspCT3dXK93uVvYZh18yPmekirUaXpoXshHv\"]' id=dontcare\n"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"Quan s\xe1t k\u1ebft qu\u1ea3 tr\u1ea3 v\u1ec1"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "id": "dontcare",\n  "jsonrpc": "2.0",\n  "result": {\n    "gas_price": "5000"\n  }\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"Price c\u1ee7a m\u1ed9t gas unit \u1edf block n\xe0y l\xe0 5000 yoctoNEAR (10^-24 NEAR)."}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"some-closing-thoughts-from-the-whitepaper",children:"M\u1ed9t v\xe0i k\u1ebft lu\u1eadn t\u1eeb whitepaper"}),"\n",(0,c.jsxs)("blockquote",{class:"info",children:[(0,c.jsx)(e.p,{children:"V\u1ec1 c\u01a1 b\u1ea3n, NEAR platform l\xe0 m\u1ed9t marketplace gi\u1eefa nh\u1eefng ng\u01b0\u1eddi tham gia.  V\u1ec1 ph\xeda cung c\u1ea5p, nh\u1eefng ng\u01b0\u1eddi \u0111i\u1ec1u khi\u1ec3n c\xe1c node validator, c\xe1c c\u01a1 s\u1edf h\u1ea1 t\u1ea7ng c\u01a1 b\u1ea3n kh\xe1c c\u1ea7n \u0111\u01b0\u1ee3c khuy\u1ebfn kh\xedch \u0111\u1ec3 cung c\u1ea5p c\xe1c d\u1ecbch v\u1ee5 n\xe0y \u0111\u1ec3 t\u1ea1o m\u1ed9t \u201ccommunity cloud.\u201d  V\u1ec1 ph\xeda nh\u1eefng ng\u01b0\u1eddi c\xf3 nhu c\u1ea7u, c\xe1c developer v\xe0 end-user c\u1ee7a n\u1ec1n t\u1ea3ng \u0111ang tr\u1ea3 ti\u1ec1n cho vi\u1ec7c s\u1eed d\u1ee5ng c\xe1c d\u1ecbch v\u1ee5 m\xe0 nh\u1eefng ng\u01b0\u1eddi cung c\u1ea5p \u0111\u01b0a ra, c\u1ea7n \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng n\xf3 theo c\xe1ch \u0111\u01a1n gi\u1ea3n, r\xf5 r\xe0ng v\xe0 nh\u1ea5t qu\xe1n \u0111\u1ec3 n\xf3 gi\xfap \xedch cho h\u1ecd."}),(0,c.jsx)(e.p,{children:"M\u1ed9t blockchain-based cloud cung c\u1ea5p m\u1ed9t s\u1ed1 t\xe0i nguy\xean c\u1ee5 th\u1ec3 cho c\xe1c \u1ee9ng d\u1ee5ng ch\u1ea1y tr\xean n\xf3:"}),(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"Compute (CPU)"}),": \u0110\xe2y l\xe0 qu\xe1 tr\xecnh x\u1eed l\xfd th\u1ef1c t\u1ebf c\u1ee7a m\xe1y t\xednh (v\xe0 RAM kh\u1ea3 d\u1ee5ng) \u0111\u1ec3 ch\u1ea1y code trong contract."]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:'Bandwidth ("Network")'}),": \u0110\xe2y l\xe0 l\u01b0u l\u01b0\u1ee3ng c\u1ee7a network gi\u1eefa nh\u1eefng ng\u01b0\u1eddi tham gia v\xe0 c\xe1c user, bao g\u1ed3m tin nh\u1eafn \u0111\xe3 g\u1eedi c\xe1c transaction v\xe0 nh\u1eefng tin truy\u1ec1n t\u1ea3i c\xe1c kh\u1ed1i."]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"Storage"}),": L\u01b0u tr\u1eef v\u0129nh vi\u1ec5n data tr\xean c\xe1c chain, th\u01b0\u1eddng \u0111\u01b0\u1ee3c xem nh\u01b0 l\xe0 m\u1ed9t function c\u1ee7a kh\xf4ng gian v\xe0 th\u1eddi gian l\u01b0u tr\u1eef."]}),"\n"]}),(0,c.jsx)(e.p,{children:'C\xe1c blockchain hi\u1ec7n t\u1ea1i nh\u01b0 Ethereum t\xednh t\u1ea5t c\u1ea3 nh\u1eefng th\u1ee9 n\xe0y b\u1eb1ng b\u1eb1ng m\u1ed9t transaction fee tr\u1ea3 tr\u01b0\u1edbc bao g\u1ed3m t\u1ea5t c\u1ea3 c\xe1c chi ph\xed tr\xean. Tuy nhi\xean, ch\xfang ch\u1ec9 thu ph\xed developer ho\u1eb7c user m\u1ed9t l\u1ea7n duy nh\u1ea5t m\xe0 th\xf4i. \u0110\xe2y l\xe0 m\u1ed9t lo\u1ea1i ph\xed bi\u1ebfn \u0111\u1ed9ng cao th\u01b0\u1eddng g\u1ecdi l\xe0 "gas".'}),(0,c.jsx)(e.p,{children:"C\xe1c developer th\xedch vi\u1ec7c gi\xe1 c\xf3 th\u1ec3 d\u1ef1 \u0111o\xe1n \u0111\u01b0\u1ee3c \u0111\u1ec3 h\u1ecd c\xf3 th\u1ec3 l\u1eadp ng\xe2n s\xe1ch v\xe0 cung c\u1ea5p gi\xe1 cho end user c\u1ee7a h\u1ecd. Tr\xean NEAR, gi\xe1 cho c\xe1c t\xe0i nguy\xean \u0111\xe3 n\xf3i \u1edf tr\xean l\xe0 m\u1ed9t s\u1ed1 ti\u1ec1n \u0111\u01b0\u1ee3c \u0111i\u1ec1u ch\u1ec9nh t\u1eeb t\u1eeb d\u1ef1a tr\xean vi\u1ec7c s\u1eed d\u1ee5ng h\u1ec7 th\u1ed1ng (v\xe0 t\xf9y thu\u1ed9c v\xe0o \u0111\u1ed9 m\u01b0\u1ee3t m\xe0 c\u1ee7a resharding trong qu\xe1 tr\xecnh s\u1eed d\u1ee5ng kh\u1eafc nghi\u1ec7t) thay v\xec ho\xe0n to\xe0n d\u1ef1a tr\xean vi\u1ec7c \u0111\u1ea5u gi\xe1. \u0110i\u1ec1u n\xe0y c\xf3 ngh\u0129a l\xe0 developer c\xf3 th\u1ec3 d\u1ef1 \u0111o\xe1n \u0111\u01b0\u1ee3c chi ph\xed c\u1ee7a vi\u1ec7c ch\u1ea1y c\xe1c transaction ho\u1eb7c duy tr\xec b\u1ed9 nh\u1edb c\u1ee7a ch\xfang."})]}),"\n",(0,c.jsxs)(e.p,{children:["\u0110\u1ec3 t\xecm hi\u1ec3u s\xe2u h\u01a1n v\u1ec1 c\xe1ch th\u1ee9c v\xe0 l\xfd do t\u1ea1i sao gas ho\u1ea1t \u0111\u1ed9ng theo c\xe1ch nh\u01b0 th\u1ebf tr\xean NEAR, h\xe3y xem ph\u1ea7n ",(0,c.jsx)(e.a,{href:"https://near.org/papers/the-official-near-white-paper/#economics",children:"Economics"})," c\u1ee7a main whitepaper v\xe0 ph\u1ea7n ",(0,c.jsx)(e.a,{href:"https://near.org/papers/economics-in-sharded-blockchain/#transaction-and-storage-fees",children:"Transaction and c\xe1c Storage Fee"})," c\u1ee7a economics whitepaper."]}),"\n",(0,c.jsx)(e.admonition,{title:"Got a question?",type:"tip",children:(0,c.jsx)("a",{href:"https://stackoverflow.com/questions/tagged/nearprotocol",children:" Ask it on StackOverflow! "})})]})}function d(n={}){const{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(l,{...n})}):l(n)}},11151:(n,e,t)=>{t.d(e,{Z:()=>h,a:()=>a});var c=t(67294);const s={},i=c.createContext(s);function a(n){const e=c.useContext(i);return c.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function h(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),c.createElement(i.Provider,{value:e},n.children)}}}]);